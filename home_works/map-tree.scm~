
;;Exercise 2.30

(define (square-tree tree)
  (cond ((null? tree) nil)
	((list? tree)
	 (cons (square-tree (car tree)) (square-tree (cdr tree))))
	(else (* tree tree))))

;;A version using map of list
(define (square-map-tree tree)
  (map (lambda (sub-tree)
	 (if (list? sub-tree)
	     (square-map-tree sub-tree)
	     (* sub-tree sub-tree)))
       tree))

;;Exercise 2.31
;;An abstraction of (map func list)
(define (tree-map func tree)
  (cond ((null? tree) nil)
	((list? tree)
	 (cons (tree-map func (car tree)) (tree-map (cdr tree))))
	(else (func tree))))

;;Exercise 2.32: Generate set of all subsets of a set
(define (subsets set)
  (if (null? set)
      (list nil)
      (let ((rest (subsets (cdr set))))
	(append rest (map (lambda (subset)
			    (cons (car set) subset))
			  rest)))))



