

;; A procedure that counts syllables in a word,
;; by only counting the vowels 
;; (consecutive ones counts for one)
(define syllables 
  (lambda (a-word)
    (define vowel?
      (lambda (char) (member char '(a e i o u))))
    (define count
      (lambda (a-word consecutive acc)
        (cond ((empty? a-word) acc)
              ((and (vowel? (first a-word)) (not consecutive))
               (count (butfirst a-word) true (+ acc 1)))
              (else (count (butfirst a-word) false acc)))))
    (count a-word false 0)))


;; takes a predicate ordering and a list as input
;; and checks if the list is ordered accoridng to ordering
(define in-order?
  (lambda (ordering a-list)
    (cond ((< (length a-list) 2) true)
          ((ordering (first a-list) (first (rest a-list)))
            (in-order? ordering (rest a-list)))
          (else false))))
          
;;predicate: a function that defines ordering
;;returns a function with one argument, the list to check order of)
;;according to predicate
(define order-checker
  (lambda (predicate)
    (define iterate-check
      (lambda (a-list)
        (cond ((< (length a-list) 2) true)
              ((predicate (first a-list) (first (rest a-list)))
               (iterate-check (rest a-list)))
              (else false))))
    iterate-check))
    
;;constructor and selctor procedures for the abstract data type time
(define make-time 
	(lambda (hr mn cat)
		(define number-format
			(lambda (hr mn) (+ (* 100 hr) mn)))
	(if (equal? cat 'am)
		(number-format hr mn)
		(number-format (+ hr 12) mn))))

(define hour (lambda (time) 
	(/ (- time (modulo time 100)) 100)))
(define minute (lambda (time) (modulo time 100)))
(define category (lambda (time) (if (> time 1200) 'pm 'am)))

(define time-print-form
	(lambda (time) (word (hour time) ': (minute time) 
									 (category time))))

(define (24-hour time)
	(define number-format
		(lambda (hr mn) (+ (* 100 hr) mn)))
	(if (equal? (category time) 'am)
		(number-format (hour time) (minute time))
		(number-format (+ (hour time) 12) (minute time))))
















